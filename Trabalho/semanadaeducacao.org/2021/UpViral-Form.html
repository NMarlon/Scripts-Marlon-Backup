
<script>
    function setCookie(cname, cvalue, exdays) {
      var d = new Date();
      d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
      var expires = "expires="+d.toUTCString();
      document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
    }


    function getCookie(cname) {
      var name = cname + "=";
      var ca = document.cookie.split(';');
      for(var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
          c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
          return c.substring(name.length, c.length);
        }
      }
      return "";
    }




    function checarVariavelDoLink(link,variavel){
      var i=0;
      var valor = "";
      var variavel_pointer_link= "";
      var link_length = link.length;

      while(i<link_length){ 
        if(link[i]=="?"){
          var j=i+1;
          var EhAVariavel = true;
          var lastTurn=false;
          while(j<link_length){
            if(EhAVariavel){
              variavel_pointer_link=variavel_pointer_link+link[j]; 

            }else{
              valor+=link[j];
            }
            var jj=j+1;
            if(variavel_pointer_link==variavel && link[jj]=="="){
              EhAVariavel=false;
              lastTurn=true;
              j+=1;
            }else{
              if(link[jj]=="="){
                variavel_pointer_link="";
                EhAVariavel=false;
                j+=1;
              }
            }
            
            if(lastTurn==true && (link[jj]=="&" || link[jj]==undefined)){
              return valor; 
            } 
            if(link[j]=="&"){
              valor="";
              EhAVariavel=true;  
            }
            
           /* //valor= valor.concat(valor,link[j]); 
            console.log(valor+"; var"+variavel);
            if (link[j]=="="){
                if(valor==variavel){
                    EhAVariavel=true;
                    console.log("ok");
                }
                valor="";
            }
            valor=valor.co  ncat(link[j]); 
            j+=1;
           
            if(link[j]=="&"){
                j+=1;
            }else {
                if(EhAVariavel){ 
                    return valor;
                }
                
            }
            if(j>=link_length){
                
                console.log(j+"; "+link_length+"; Cutim: "+valor); 
                return valor;
              }*/
              j=j;
              j+=1; 
            }
            break;  
          }
          i+=1;
        }

    } 
    function prepareData(data) {
        return Object.keys(data).map(function(key) {
            return [key, data[key]].join('=');
        }).join('&');
    }

    function parseURI(str) {
        var data = {};
        str.split('&').forEach(function(keyValue){
            var parts = keyValue.split('=');
            data[parts[0]] = parts[1];
        });
        return data;
    }

   function sleep (time) {
      return new Promise((resolve) => setTimeout(resolve, time));
    }
    //console.log(parent.document.location.href); 

    
    function gup( name, url ) {
        if (!url) url = location.href;
        name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
        var regexS = "[\\?&]"+name+"=([^&#]*)";
        var regex = new RegExp( regexS );
        var results = regex.exec( url );
        return results == null ? null : results[1];
    }
    function redirect_yes_or_no(){
        //var ref = encodeURI(parent.document.location.href);
        //var link_referencia_upviral = getCookie("lead_ok");


        //ref = "https://semanadaeducacao.org" +ref; //result: https://semanadaeducacao.orghttps//semanadaeducacao.org/upviral-form/
        //if(link_referencia_upviral!="true"){
            setCookie("veio_por_link_cookie","true",1);
            window.top.location.replace("https://semanadaeducacao.org/?veio_por_link=true");                    
        //}
    }
    //gup('q', 'hxxp://example.com/?q=abc')
    console.log(window.parent.location.href.toString());
    function link_onload(){
        sleep(100).then(() => {
            //var url_upviral=  parent.window.location;
            //var ref_id_link = checarVariavelDoLink(url_upviral,"ref_id");
            //var url_string = "http://www.example.com/t.html?a=1&b=3&c=m2-m3-m4-m5"; //parent.document.location.href
            //var url_upviral_transform = new URL(url_upviral);
            //var ref_id_link =window.parent.document.getlEDOMException: Permission denied to access property "document" on cross-origin objectementsByClassName("reflink").value;//window.JsConfig["refered_by_visitor"]; //url_upviral_transform.searchParams.get("ref_id");
            //console.log(c);

            //var ref_id_link = gup("ref_id",url_upviral);
            //console.log(ref_id_link+" AQUI O link!!");
            //hecarVariavelDoLink("leadok","");
            var leadok =getCookie("lead_ok");//document.cookie.split(';')['lead_ok']
            
            console.log(leadok+ " LEADOK");
            if(leadok != "true"){
                //var ref ="https://semanadaeducacao.org/?ref_id_link=" + ref_id_link;
                if(document.location.href.search("elementor")==-1 && document.location.href.search("iral.com/editor/index/")==-1){
                    //console.log("work");
                    redirect_yes_or_no();
                    //window.top.location.replace("https://semanadaeducacao.org");

                    //window.location.replace("https://semanadaeducacao.org");
                    //parent.document.location.href="https://semanadaeducacao.org";
                    //window.location=("https://semanadaeducacao.org");

                } else{
                    if(window.confirm("Deseja ir para página oficial da Semana Da Educação 2021? (https://semanadaeducacao.org) ")) 
                        //location.replace("https://semanadaeducacao.org");
                        redirect_yes_or_no();
                       
                       //window.top.location.replace("https://semanadaeducacao.org");

                    
                }  
               
            }
        });

    }

    window.onload = function(){   
        link_onload();
           
     
    };
    //document.getElementById("upv_form_1612426535_0").value="teste";
    //https://upvir.al/117271/teste
    //https://upvir.al/ref/Gg58990026 //Teste Redirecionamento 
    //https://semanadaeducacao.org/upviral-form
</script>